<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniGame</title>

    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.7.2/aframe/build/aframe-ar.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<script>
    AFRAME.registerComponent('for_a_marker', {
        init: function () {
            var play = document.getElementById('Play');
            var highscore = document.getElementById('HighScore');
            var header = document.getElementById('Header');
            var pplane = document.getElementById('P-Plane');
            var hsplane = document.getElementById('HS-Plane');
            
            var headerquestion = document.getElementById('H-Question');
            var qA = document.getElementById('A');
            var qB = document.getElementById('B');
            var qC = document.getElementById('C');
            var qD = document.getElementById('D');
            var num = 0;
            var score = 0;

            var endheader = document.getElementById('EndHeader');
            var gohome = document.getElementById('GoHome');
            var playagain = document.getElementById('PlayAgain');
            
            // To Hide all but Start 
            qA.setAttribute('position', '0 100 100');
            qB.setAttribute('position', '0 100 100');
            qC.setAttribute('position', '0 100 100');
            qD.setAttribute('position', '0 100 100');

            // endheader.setAttribute('value', '');
            // gohome.setAttribute('position', '0 100 100');
            // playagain.setAttribute('position', '0 100 100');
            
            //Change to Question 1
            function changeQuestion1(e) {
                num++;
                qA.setAttribute('color', 'white');
                qB.setAttribute('color', 'white');
                qC.setAttribute('color', 'white');
                qD.setAttribute('color', 'white');
                
                headerquestion.setAttribute('value', 'Where did Willem Adriaan de Wit come from before landing in Malacca?');
                qA.setAttribute('position', '-1.7 0.75 -4');
                qB.setAttribute('position', '0.4 0.75 -4');
                qC.setAttribute('position', '-1.4 0.75 -3.4');
                qD.setAttribute('position', '0.5 0.75 -3.4');

                qA.setAttribute('value', 'Johannesburg');
                qB.setAttribute('value', 'Cape Town');
                qC.setAttribute('value', 'Durban');
                qD.setAttribute('value', 'Portugal');

                qA.setAttribute('width', '5');
                qB.setAttribute('width', '5');
                qC.setAttribute('width', '5');
                qD.setAttribute('width', '5');
            }

            // Change to Question 2
            function changeQuestion2(e) {
                num++

                qA.setAttribute('color', 'white');
                qB.setAttribute('color', 'white');
                qC.setAttribute('color', 'white');
                qD.setAttribute('color', 'white');
                
                headerquestion.setAttribute('value', 'What was the name  given to Petrus Johannes de Witâ€™s Father In Law, Adriaan Koek by the Malay rulers?');
                qA.setAttribute('value', 'The Merchant');
                qB.setAttribute('value', 'Tuan Raja');
                qC.setAttribute('value', 'The Trader');
                qC.setAttribute('position', '-1.7 0.75 -3.4');
                qD.setAttribute('value', 'Tuan Raja Muda');
                qD.setAttribute('position', '0.2 0.75 -3.4');
            }

            //Change to Question 3
            function changeQuestion3(e) {
                num++

                qA.setAttribute('color', 'white');
                qB.setAttribute('color', 'white');
                qC.setAttribute('color', 'white');
                qD.setAttribute('color', 'white');

                headerquestion.setAttribute('value', 'Which occupation did the grandfather, John Charles De Witt have that brought the family much recognition?');
                qA.setAttribute('value', 'Working with Seafield Estates');
                qA.setAttribute('position', '-1.75 0.75 -4');
                qA.setAttribute('width', '2.6');

                qB.setAttribute('value', 'Signal Master at Malayan Railways4');
                qB.setAttribute('position', '0.2 0.75 -4');
                qB.setAttribute('width', '2.2');

                qC.setAttribute('value', 'Distributor of Singer Sewing Machines for Southern Malaya');
                qC.setAttribute('position', '-1.75 0.75 -3.4');
                qC.setAttribute('width', '1.9');

                qD.setAttribute('value', 'None of the above');
                qD.setAttribute('position', '0.4 0.75 -3.4');
                qD.setAttribute('position', '0.4 0.75 -3.4');
                qD.setAttribute('width', '2.9');
            }

            function endGame(e) {
                //Clean
                headerquestion.setAttribute('value', '');
                qA.setAttribute('position', '0 100 100');
                qB.setAttribute('position', '0 100 100');
                qC.setAttribute('position', '0 100 100');
                qD.setAttribute('position', '0 100 100');
                //play.removeEventListener("click", evt);

                //Create
                header.setAttribute('position', '-1.57 1 -4.5');
                play.setAttribute('position', '0.5 0.75 -3.7');
                highscore.setAttribute('position', '-1.5 0.75 -3.7');
                header.setAttribute('value', 'Thank you for playing!');
                highscore.setAttribute('value', 'Go Home');
                play.setAttribute('value', 'Play Again');
            }

            //Game
            play.addEventListener("click", function (mouseenter) {
                // Clean
                num = 0;
                header.setAttribute('position', '0 100 100');
                play.setAttribute('position', '0 100 100');
                highscore.setAttribute('position', '0 100 100');
                
                // Question 1
                changeQuestion1 ();
            });

            // Checking Answer
            [ qA, qB, qC, qD ].forEach(function(element) {
                element.addEventListener("click", function(evt) {
                    if (event.currentTarget.id == "B" && num == 1){
                        event.currentTarget.setAttribute('color', 'green');
                        score++;
                    }
                    else if (event.currentTarget.id == "D" && num == 2){
                        event.currentTarget.setAttribute('color', 'green');
                        score++;
                    } 
                    else if (event.currentTarget.id == "C" && num == 3){
                        event.currentTarget.setAttribute('color', 'green');
                        score++;
                    }
                    else {
                        event.currentTarget.setAttribute('color', 'red');
                    }
                    
                    if (num == 1){
                        setTimeout(function(){
                            changeQuestion2 ();
                        },1000);
                    }
                    else if (num == 2){
                        setTimeout(function(){
                            changeQuestion3 ();
                        },1000);                      
                    } 
                    else {
                        setTimeout(function(){
                            endGame ();
                        },1000);
                    }   
                    
                });
            });


            playagain.addEventListener("click", function (mouseenter) { 
                // Clean
                // endheader.setAttribute('value', '');
                // gohome.setAttribute('position', '0 100 100');
                // playagain.setAttribute('position', '0 100 100');

                // num = 0;
                // // Display
                // header.setAttribute('value', 'Do you know the DeWitt Family?');
                // play.setAttribute('value', 'Play');
                // highscore.setAttribute('value', 'Highscore');
                // alert(num);
                num = 0;
            });

        }
    });

</script>

<body style='margin : 0px; overflow: hidden;'>
    <a-scene embedded arjs='debugUIEnabled: false; sourceType: webcam' vr-mode-ui='enabled: false'>
        <a-entity cursor="rayOrigin: mouse" raycaster="objects: .intersectable; useWorldCoordinates: true;"></a-entity>

        <a-marker-camera id="marker" preset="hiro" emitevents="true" for_a_marker>
            <a-entity position="0 0 2" scale="0.5 0.5 0.5">
                <!-- Header -->
                <a-text id="Header" value="Do you know the DeWitt Family?" position="-1.57 1 -4.5" rotation="-90 0 0"></a-text> 

                <!-- HighScore Btn -->
                <a-text id="HighScore" class="intersectable" value="High Scores" position="-1.5 0.75 -3.7" rotation="-90 0 0" color='green'></a-text>
                <!-- <a-plane id="HS-Plane" position="-0.9 0.6 -3.7" rotation="-90 0 0" width="1.0" height="0.5" color="red" material="transparent: true; opacity: 0.5"></a-plane> -->
                
                <!-- Play Btn -->
                <a-text id="Play" class="intersectable" value="Play" position="0.5 0.75 -3.7" rotation="-90 0 0" color='red'></a-text>
                <!-- <a-plane id="P-Plane" position="0.7 0.6 -3.7" rotation="-90 0 0" width="0.7" height="0.5" color="green" material="transparent: true; opacity: 0.5"></a-plane>  -->
                
                <!-- Header Question -->
                <a-text id="H-Question" value="" width="3.8" position="-1.8 1 -4.6" rotation="-90 0 0"></a-text>  

                <!-- Choices -->
                <a-text id="A" class="intersectable" value="Johannesburg" position="-1.7 0.75 -4" width="5" rotation="-90 0 0" color="white"></a-text>
                <a-text id="B" class="intersectable" value="Cape Town" position="0.4 0.75 -4" width="5" rotation="-90 0 0" color="white"></a-text>
                <a-text id="C" class="intersectable" value="Durban" position="-1.4 0.75 -3.4" width="5" rotation="-90 0 0" color="white"></a-text>
                <a-text id="D" class="intersectable" value="Portugal" position="0.5 0.75 -3.4" width="5" rotation="-90 0 0" color="white"></a-text>

                 <!-- End Header -->
                 <!-- <a-text id="EndHeader" value="Thank you for playing!" position="0 1 -4.5" rotation="-90 0 0" align ="center"></a-text>  -->

                 <!-- Go Home -->
                 <!-- <a-text id="GoHome" class="intersectable" value="Go Home" position="-1.5 0.75 -3.7" rotation="-90 0 0" color="blue"></a-text> -->
                 
                 <!-- Play Again -->
                 <!-- <a-text id="PlayAgain" class="intersectable" value="Play Again" position="0.5 0.75 -3.7" rotation="-90 0 0" color="blue"></a-text>  -->

                <!-- Container -->
                <a-plane position="0 0.25 -4" rotation="-90 0 0" width="4.5" height="2.2" color="black" material="transparent: true; opacity: 0.5"></a-plane>
            </a-entity>
        </a-marker-camera>
    </a-scene>
</body>

</html>
